<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 2.0.0-M16 from src/site/xdoc/getting-started.xml.vm at 05 Feb 2024
 | Rendered using Apache Maven Fluido Skin 2.0.0-M8
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 2.0.0-M16" />
    <meta name="author" content="The MyBatis Team" />
    <title>mybatis-guice – MyBatis Guice | Getting started</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-2.0.0-M8.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-2.0.0-M8.min.js"></script>
  </head>
  <body>
    <div class="container-fluid container-fluid-top">
      <header>
        <div id="banner">
          <div class="pull-left"></div>
          <div class="pull-right"><div id="bannerRight"><h1><a href="https://blog.mybatis.org/" class="externalLink"><img class="imageLink" src="https://www.mybatis.org/images/mybatis-logo.png" alt="MyBatis logo" /> MyBatis</a></h1></div></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 29 Jan 2024<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 4.0.1-SNAPSHOT</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Reference Documentation</li>
    <li><a href="index.html">Introduction</a></li>
    <li class="active"><a>Getting Started</a></li>
    <li><a href="core.html">Core components</a></li>
    <li><a href="datasources.html"><span class="icon-chevron-down"></span>Data Sources</a>
     <ul class="nav nav-list">
      <li><a href="datasources/builtin.html">MyBatis built-in</a></li>
      <li><a href="datasources/dbcp.html">Apache Commons DBCP</a></li>
      <li><a href="datasources/c3p0.html">C3P0</a></li>
      <li><a href="datasources/hikaricp.html">HikariCP</a></li>
      <li><a href="datasources/druid.html">Druid</a></li>
     </ul></li>
    <li><a href="injections.html">Injections</a></li>
    <li><a href="transactional.html">@Transactional</a></li>
    <li><a href="jta.html">JTA</a></li>
    <li><a href="jdbc-helper.html">JDBC Helper</a></li>
    <li><a href="samples.html">Samples</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="https://maven.apache.org/" class="builtBy" target="_blank"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn" class="span10">


  
    <section>
<h1>Getting started</h1>
  
<p>
    MyBatis-Guice helps you integrate your MyBatis code seamlessly with
    Google Guice. Using the classes in this library, Google Guice will load
    the necessary MyBatis classes for you. This library also provides
    an easy way to inject MyBatis data mappers and <code>SqlSessions</code>
    into your application beans.
    Finally, MyBatis-Guice will let you demarcate transactions declaratively
    so you won't need to commit/rollback/close them by hand.
  </p>
  </section>

  <section>
<h1>Installation</h1>
        
<p>
            Installing the mybatis-guice module it is very easy, just put the
            <code>mybatis-guice-4.0.1-SNAPSHOT.jar</code> and
            dependencies in the classpath!
        </p>
        
<p>
            Apache Maven users instead can easily adding the following dependency
            in their POMs :
            </p>
<div class="verbatim source"><pre class="prettyprint">&lt;dependencies&gt;
...
  &lt;dependency&gt;
    &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis-guice&lt;/artifactId&gt;
    &lt;version&gt;4.0.1-SNAPSHOT&lt;/version&gt;
  &lt;/dependency&gt;
...
&lt;/dependencies&gt;</pre></div>
        
  </section>

  <section>
<h1>Quick Setup</h1>
    
<p>
      To use MyBatis with Guice you need to set up a <code>MyBatisModule</code>,
      with a <code>DataSource</code> at least one data mapper class and
      a transactional bean to be injected with the mapper.
    </p>

    
<p>
      To setup a <code>DataSource</code> you can simply use the <code>JdbcHelper</code> (please see the
      related appendix for more informations) module to build the URL needed for your database and provide the
      connection properties:
      </p>
<div class="verbatim source"><pre class="prettyprint">Properties myBatisProperties = new Properties();
myBatisProperties.setProperty(&quot;mybatis.environment.id&quot;, &quot;test&quot;);
myBatisProperties.setProperty(&quot;JDBC.schema&quot;, &quot;mybatis-guice_TEST&quot;);
myBatisProperties.setProperty(&quot;derby.create&quot;, &quot;true&quot;);
myBatisProperties.setProperty(&quot;JDBC.username&quot;, &quot;sa&quot;);
myBatisProperties.setProperty(&quot;JDBC.password&quot;, &quot;&quot;);
myBatisProperties.setProperty(&quot;JDBC.autoCommit&quot;, &quot;false&quot;);

Injector injector = Guice.createInjector(
    JdbcHelper.HSQLDB_Embedded,
    new Module() {
        public void configure(Binder binder) {
            Names.bindProperties(binder, myBatisProperties);
        }
    }
);</pre></div>
   

   
<p>
      Assume you have a data mapper class defined like the following:

      </p>
<div class="verbatim source"><pre class="prettyprint">public interface UserMapper {

    @Select(&quot;SELECT * FROM user WHERE id = #{userId}&quot;)
    User getUser(@Param(&quot;userId&quot;) String userId);

}</pre></div>

      Note that the mapper class specified <i>must</i> be an
      interface, not an actual implementation class. In this example,
      annotations are used to specify the SQL, but a MyBatis mapper XML file
      could also be used.
   

   
<p>
      Assume you also have a transactional service bean that uses your mapper:

      </p>
<div class="verbatim source"><pre class="prettyprint">public class FooServiceMapperImpl implements FooService {

    @Inject
    private UserMapper userMapper;

    @Transactional
    public User doSomeBusinessStuff(String userId) {
        return this.userMapper.getUser(userId);
    }

}</pre></div>
   

   
<p>
      Setup a <code>MyBatisModule</code>, add your mapper to it and bind also 
      your transactional service interface <code>FooService</code> to its implementation.
      </p>
<div class="verbatim source"><pre class="prettyprint">public interface UserMapper {
...
Injector injector = Guice.createInjector(
    new MyBatisModule() {

        @Override
        protected void initialize() {
            install(JdbcHelper.HSQLDB_Embedded);

            bindDataSourceProviderType(PooledDataSourceProvider.class);
            bindTransactionFactoryType(JdbcTransactionFactory.class);
            addMapperClass(UserMapper.class);

            Names.bindProperties(binder(), createTestProperties());
            bind(FooService.class).to(FooServiceMapperImpl.class);
        }

    }
);</pre></div>
   

    
<p>
       This is all you need, you can now get an instance of your service. It will
       be automatically injected with the MyBatis mapper. With the mapper calling
       MyBatis data methods is only one line of code. Besides, all operations will 
       be transactional, that means that you will not need to commit or rollback 
       any connection. 
      </p>
<div class="verbatim source"><pre class="prettyprint">FooService fooService = this.injector.getInstance(FooService.class);
fooService.doSomeBusinessStuff(&quot;data&quot;);</pre></div>
     
  </section>

    


        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>©      2009–2024
<a href="https://www.mybatis.org/">MyBatis.org</a>
</p>
        </div>
      </div>
    </footer>
<script>
  if(anchors) {
    anchors.add();
  }
</script>
  </body>
</html>
